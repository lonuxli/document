# 并发同步之内核并发

内核态并发分析

|系统类型                     |被打断内核路径                         |并发打断内核路径                                                                                                              |备注                                                                                                                 |代码依据分析|
|-----------------------------|---------------------------------------|------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|------------|
|单核系统                     |中断处理程序A                          |无                                                                                                                            |Linux不支持中断嵌套，所以不同中断处理程序不会并发                                                                    |　          |
|软中断A                      |中断处理程序B                          |单核系统软中断不会嵌套                                                                                                        |　                                                                                                                   |            |
|tasklet A                    |中断处理程序B                          |单核系统软中断不会嵌套                                                                                                        |　                                                                                                                   |            |
|进程上下文A\(支持内核抢占\)  |软中断处理程序B

中断处理程序B
进程上下文B|内核态中，调度器可以抢占当前正在运行的进程，重新调度其他进程运行，从而导致单核系统中进程上下文存在并发的可能性。              |　                                                                                                                   |            |
|进程上下文A\(不支持内核抢占\)|中断处理程序B
软中断处理程序B           |内核态进程上下文中，进程只有显式的调度让出CPU，其他进程才有机会得到运行，因此其他进程不会打断当前运行中的进程。               |　                                                                                                                   |            |
|SMP系统                      |中断处理程序A                          |中断处理程序B                                                                                                                 |同一类型的中断处理程序不会并发，但是不同类型的中断有可能送达到不同的CPU上，因此不同类型的中断处理程序可能存在并发执行|　          |
|软中断处理程序A              |中断处理程序B
软中断处理程序B           |同一类型的软中断会在不同的CPU上并发                                                                                           |　                                                                                                                   |            |
|Tasklet A                    |中断处理程序B
软中断处理程序B           |Tasklet基于优先级5的软中断实现，同一类型的tasklet串行执行，不会在多个CPU上并发，因此tasklet不会类似其他软中会在过个CPU上并发。|　                                                                                                                   |            |
|进程上下文A                  |软中断处理程序B

中断处理程序B
进程上下文B|不同CPU上的进程上下文会并发运行，包括关闭内核抢占的系统。                                                                     |　                                                                                                                   |            |
